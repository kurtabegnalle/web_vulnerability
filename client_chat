import socket

print('Для выхода из чата наберите: `exit`, `quit` или `q`.')
# Удаленный хост
HOST = '127.0.0.1'
# тот же порт, что и у сервера
PORT = 8008
REGISTRATION = True
USER_NAME = "user"
PASSWORD = "123"
DELIMITER = "<0x12b>"
STATUS_OK = "200"
STATUS_ERROR = "300"


def auth(socket):
    mess = f"{USER_NAME}{DELIMITER}{PASSWORD}"
    socket.sendall(mess.encode('utf-8'))
    try:
        data = sock.recv(1024)
        data = data.decode('utf-8')
        if data == STATUS_OK:
            print("Аутентификация пройдена!")
        elif data == STATUS_ERROR:
            print("Некорректный ответ сервера")
        else:
            print(data)
    except:
        print("Ошибка связи с сервером!")


with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
    sock.connect((HOST, PORT))
    if REGISTRATION:
        auth(sock)
    while True:
        mess = input('\nВведите что нибудь >>> ')
        if any(mess.lower() in ext for ext in ['quit', 'exit', 'q']):
            break
        mess = mess.encode('utf-8')
        sock.sendall(mess)
        data = sock.recv(1024)
        print('\nПолучено: ', data.decode('utf-8'))
